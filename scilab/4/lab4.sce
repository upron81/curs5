Y = [7941.1; 11193.7; 9923.6; 6441.2; 8024.9; 5094.2; 7755.2; 6641.0; 9501.4; 11984.9; 6794.2; 8462.2; 6572.9; 6952.0; 7288.0; 7364.4; 5742.0; 10202.2; 7895.2];
X1 = [6773,9; 17663,1; 15657,6; 14918,7; 14334,5; 9059,6; 16329,4; 6668,6; 25650,8; 18391,0; 9919,6; 12633,8; 15966,7; 11180,3; 12720,7; 19859,3; 11110,2; 19039,9; 14635,7];
X2 = [34,8; 23,3; 18,1; 20,6; 20,2; 18,0; 22,8; 27,6; 16,5; 18,9; 12,8; 23,2; 19,0; 25,0; 24,6; 20,7; 32,1; 24,2; 22,4];
X3 = [1285,63; 1816,52; 1523,58; 1539,46; 724,16; 1036,19; 1773,48; 1245,01; 1020,47; 1937,11; 253,16; 1060,90; 866,50; 1298,73; 1626,90; 931,76; 1057,05; 1683,96; 1202,91];
X4 = [838,99; 1133,25; 1722,58; 1270,27; 728,06; 1314,51; 396,21; 1176,72; 1715,50; 2354,55; 1267,62; 1961,94; 314,37; 2320,66; 1119,05; 938,37; 49,36; 1386,83; 711,93];

n = length(Y); // Количество наблюдений
X = [ones(n,1), X1, X2, X3, X4]; // Матрица признаков с единичным столбцом для свободного члена
p = size(X,2); // Количество параметров (5: свободный член и 4 независимые переменные)

// Оценка коэффициентов регрессии
beta = X \ Y;

// Вычисление предсказанных значений Y
Y_hat = X * beta;

// Вычисление остатков (невязок)
residuals = Y - Y_hat;

// Вычисление общей суммы квадратов (SST)
SST = sum((Y - mean(Y)).^2);

// Вычисление суммы квадратов ошибок (SSE)
SSE = sum(residuals.^2);

// Вычисление регрессионной суммы квадратов (SSR)
SSR = SST - SSE;

// Степени свободы
DF_total = n - 1;        // Общая степень свободы
DF_regression = p - 1;   // Степени свободы регрессии (4)
DF_error = n - p;        // Степени свободы ошибки (14)

// Средние квадраты
MSR = SSR / DF_regression; // Средний квадрат регрессии
MSE = SSE / DF_error;      // Средний квадрат ошибки

// F-статистика
F_stat = MSR / MSE;

// Критическое значение F для α=0.05 и df1=4, df2=14 (из таблицы F-распределения)
F_critical = 3.0069;

// Вывод результатов
disp("Коэффициенты регрессии beta:");
disp(beta);

disp("F-статистика:");
disp(F_stat);

disp("Критическое значение F:");
disp(F_critical);

if F_stat > F_critical then
    disp("Уравнение регрессии значимо при уровне значимости α=0.05");
else
    disp("Уравнение регрессии не значимо при уровне значимости α=0.05");
end

// Оценка невязок
disp("Остатки (невязки):");
disp(residuals);
